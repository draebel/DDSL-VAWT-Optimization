# DDSL-VAWT-Optimization

## makelist.sh (bash)
This gets the `.dat` files from the cleaned data 1636 airfoils associated with [DDSL experiment 1](https://github.com/maxjiang93/DDSL/tree/pub/experiments/exp1_airfoil).
```
 ./makelist.sh <full_path_to_input_data_folder> <full_path_to_output_folder>
 ```
This will create a `DatFiles` directory and an `AirfoilList.txt` file in the output folder.

## CPProcessor.m (Matlab R2018b)
This uses a spline function to interpolate a desired number of control points from an existing airfoil `.dat` file.

Place this file into the `DatFiles` directory and run. When completed, the control point files will be located in the `Control Point Files` directory.

## CaseWriter.py (Python 3)
This randomly chooses (with replacement) 1000 cases from the list of airfoils generated by `makelist.sh`. It reports `Airfoil,TSR (Tip Speed Ratio),AoA (Angle of Attack),AngularSpeed` of each case in CSV format. Must be in same directory as `AirfoilList.txt`. 

## process_airfoil_shapes_from_csv.py (Python 3)
This file must be run in the directory associated with [DDSL experiment 1](https://github.com/maxjiang93/DDSL/tree/pub/experiments/exp1_airfoil). Move this file and `CaseList.txt` generated from `CaseWriter.py` and run. This script will create polygon files from the airfoil necessary for training the neural network. 

## FakeValidationData.sh (bash)
This script will produce "fake" CFD data for validating the neural network. This script calls `FakeDataWriterSinWave.py` which will generate fake CFD data in the form of a squared sine wave with a random magnitude. It then calls `SplitFakeData.py` which generates separate CSV files for each case, and lastly calls `process_cfd_data.py` to extract mean and standard deviation statistics, and to normalize the data for input into the neural network. These files can be used to "train" the neural network to ensure it is working properly.

## vawtopmaker/ (bash)

This folder makes OpenFOAM cases from a template (CleanCase/). It calculates timestep from the Python file (based on Haris's tests).

To make the cases, you can `mkdir cases` in that directory, then run
```
ls  ~/Desktop/DDSL-VAWT-Optimization/Final/geo_files/ | while read -r line; do ./make_case.sh ~/Desktop/DDSL-VAWT-Optimization/Final/geo_files/$line; done
```
Then you can run `./foamrun` in each repository to generate the mesh. Running `./foamrun_docker` will convert the mesh to OpenFOAM, and `./foamrun_final` will send the script to Comet.



## postprocess/ (matlab, to be python)
This script takes the results of the OpenFOAM processing and converts it into torques at every angle.

Haris originally wrote this in matlab, which we will convert to Python.